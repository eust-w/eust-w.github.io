---
layout: post
tags: web
---



## 幂等去重

最近计算节点网络异常时经常出现请求未响应问题，之前的做法是在接收到任务之后与原先存在的任务做比较,进而判断是否为同一个请求的重试，

主流的MQ实现在 `autocommit=true` 时天然实现了幂等

但考虑业务处理可能出错的情况我们一般会将autocommit设置成false，在业务处理成功后再提交，这时就需要使用上述幂等方案了

在接收到消息时写入请求Token以实现去重判断（Token可为Topic+Offset）提交后删除Token，整体上可以做到对业务透明

